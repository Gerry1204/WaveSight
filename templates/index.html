<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>WaveSight</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css', v=2) }}"
    />
    <!-- Bootstrap 5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
    <!-- DataTables -->
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  </head>
  <body>
    <div class="layout-root">
      <div
        class="top-panel d-flex justify-content-between align-items-center px-4 py-2"
      >
        <!-- Brand Section -->
        <div class="d-flex align-items-center">
          <div
            class="bg-primary bg-gradient text-white rounded-3 d-flex align-items-center justify-content-center me-3 shadow-sm"
            style="width: 42px; height: 42px"
          >
            <i class="bi bi-activity fs-4"></i>
          </div>
          <div>
            <h5 class="mb-0 fw-bold" style="letter-spacing: -0.5px">
              WaveSight
            </h5>
            <div class="d-flex align-items-center mt-1">
              <span
                id="version-badge"
                class="badge bg-light text-secondary border rounded-pill fw-normal px-2 py-0"
                style="font-size: 0.7rem"
                >v1.0.2</span
              >
            </div>
          </div>
        </div>

        <!-- Right Actions -->
        <div class="d-flex align-items-center gap-3">
          <button
            class="btn btn-outline-secondary border-0 bg-body rounded-circle shadow-sm"
            style="width: 40px; height: 40px"
            id="theme-toggle"
            title="Toggle Theme"
          >
            <i class="bi bi-moon"></i>
          </button>
          <button
            class="btn btn-outline-secondary border-0 bg-body rounded-circle shadow-sm position-relative"
            style="width: 40px; height: 40px"
            title="通知 (預留功能)"
            disabled
          >
            <i class="bi bi-bell"></i>
            <span
              class="position-absolute top-0 start-75 translate-middle p-1 bg-secondary border border-light rounded-circle"
            >
              <span class="visually-hidden">New alerts</span>
            </span>
          </button>
          <button
            class="btn btn-outline-secondary border-0 bg-body rounded-circle shadow-sm"
            style="width: 40px; height: 40px"
            title="設定 (預留功能)"
            disabled
          >
            <i class="bi bi-gear"></i>
          </button>

          <div class="vr mx-1 d-none d-sm-block h-50 my-auto"></div>

          <div class="dropdown">
            <button
              class="btn p-0 border-0 d-flex align-items-center gap-2"
              type="button"
              data-bs-toggle="dropdown"
            >
              <div
                class="rounded-circle bg-dark text-white d-flex align-items-center justify-content-center shadow-sm"
                style="width: 38px; height: 38px"
              >
                <span class="fw-bold small">OP</span>
              </div>
              <span
                class="d-none d-sm-block fw-semibold small text-start lh-sm"
              >
                Operator<br />
                <small class="text-muted fw-normal">Admin</small>
              </span>
              <i class="bi bi-chevron-down fs-6 text-secondary ms-1"></i>
            </button>
            <ul class="dropdown-menu dropdown-menu-end shadow-sm border-0 mt-2">
              <li>
                <a class="dropdown-item disabled" href="#" title="預留功能"
                  ><i class="bi bi-person me-2"></i>Profile</a
                >
              </li>
              <li>
                <a class="dropdown-item disabled" href="#" title="預留功能"
                  ><i class="bi bi-layout-text-window-reverse me-2"></i
                  >Dashboard</a
                >
              </li>
              <li><hr class="dropdown-divider" /></li>
              <li>
                <a
                  class="dropdown-item disabled text-danger"
                  href="#"
                  title="預留功能"
                  ><i class="bi bi-box-arrow-right me-2"></i>Logout</a
                >
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="bottom-row">
        <div class="left-panel">
          <!-- 區塊1: 基本統計 & 範圍 -->
          <div class="card p-2 shadow-sm border-0 mb-3">
            <div class="d-flex align-items-center mb-2">
              <i class="bi bi-calculator me-2 text-primary"></i>
              <h6 class="mb-0 fw-bold">基本統計</h6>
            </div>

            <!-- 檔案與軸選 -->
            <div class="mb-2 d-flex align-items-center">
              <button
                type="button"
                class="btn btn-warning btn-sm me-2 fw-bold"
                id="import-csv-btn"
                style="min-width: 60px"
              >
                開啟
              </button>
              <label
                id="axis-label"
                class="form-label mb-0 me-2 small text-nowrap"
                >選擇範例：</label
              >
              <select
                id="axis-select"
                class="form-select form-select-sm flex-grow-1"
              ></select>
            </div>

            <!-- 範圍選擇 -->
            <div class="mb-2 d-flex align-items-center">
              <label class="form-label mb-0 me-2 small text-muted"
                >Range:</label
              >
              <input
                type="number"
                id="range-start"
                class="form-control form-control-sm me-1"
                style="width: 70px"
                min="0"
                value="0"
              />
              <span class="mx-1 text-muted">~</span>
              <input
                type="number"
                id="range-end"
                class="form-control form-control-sm ms-1"
                style="width: 70px"
                min="0"
                value="0"
              />
            </div>

            <button
              type="button"
              class="btn btn-primary btn-sm w-100 mt-1"
              id="calc-btn"
            >
              計算統計值
            </button>
          </div>

          <!-- 區塊2: 訊號處理 (平均 + 濾波) -->
          <div class="card p-2 shadow-sm border-0 mb-3">
            <div class="d-flex align-items-center mb-2">
              <i class="bi bi-graph-up-arrow me-2 text-success"></i>
              <h6 class="mb-0 fw-bold">訊號處理</h6>
            </div>

            <!-- 每N筆平均 -->
            <div class="mb-2 pb-2 border-bottom">
              <div class="d-flex align-items-center">
                <label for="avg-n" class="form-label mb-0 me-2 small"
                  >每 N 點平均:</label
                >
                <input
                  type="number"
                  id="avg-n"
                  class="form-control form-control-sm mx-1"
                  style="width: 60px"
                  min="1"
                  value="1"
                />
                <button
                  type="button"
                  class="btn btn-sm ms-auto fw-bold"
                  id="apply-avg-btn"
                  style="
                    background-color: #32cd32;
                    color: white;
                    border-color: #2eb82e;
                    min-width: 120px;
                  "
                >
                  繪製平均線
                </button>
              </div>
            </div>

            <!-- 濾波器設定 -->
            <div class="mt-2">
              <label class="form-label small mb-1">濾波器設定:</label>
              <div class="d-flex gap-1 mb-2">
                <select
                  id="filter-type"
                  class="form-select form-select-sm"
                  style="width: 100px"
                >
                  <option value="none" selected>無</option>
                  <option value="low">低通</option>
                  <option value="high">高通</option>
                  <option value="band">帶通</option>
                </select>
                <input
                  type="number"
                  id="filter-order"
                  class="form-control form-control-sm"
                  placeholder="階"
                  value="4"
                  style="width: 45px"
                  title="Order"
                />
              </div>
              <div class="d-flex align-items-center mb-2 gap-1">
                <input
                  type="number"
                  id="filter-cutoff1"
                  class="form-control form-control-sm"
                  placeholder="Hz1"
                  style="width: 100px"
                />
                <span class="small" id="cutoff-sep" style="display: none"
                  >~</span
                >
                <input
                  type="number"
                  id="filter-cutoff2"
                  class="form-control form-control-sm"
                  placeholder="Hz2"
                  style="display: none; width: 100px"
                />
                <button
                  type="button"
                  class="btn btn-sm fw-bold ms-auto"
                  id="apply-filter-btn"
                  onclick="window.applyFilter()"
                  style="
                    background-color: #ffd700;
                    color: #333;
                    border-color: #e6c200;
                    white-space: nowrap;
                    min-width: 120px;
                  "
                >
                  套用濾波
                </button>
              </div>
            </div>

            <button
              type="button"
              class="btn btn-sm w-100 mt-3 fw-bold text-white"
              id="fft-btn"
              style="background-color: #9400d3; border-color: #8000b0"
            >
              FFT 分析
            </button>
          </div>

          <!-- 第二組檔案與軸選 -->
          <div class="mt-3 border-top pt-2">
            <div class="mb-2 d-flex align-items-center">
              <button
                type="button"
                class="btn btn-warning btn-sm me-2"
                id="import-csv2-btn"
                style="min-width: 60px"
              >
                開啟
              </button>

              <select
                id="axis2-select"
                class="form-select form-select-sm flex-grow-1"
                disabled
              ></select>
            </div>

            <!-- 疊圖比較按鈕 -->
            <button
              type="button"
              class="btn btn-secondary w-100 mt-2"
              id="compare-btn"
              disabled
            >
              疊圖比較
            </button>
          </div>
        </div>
        <div class="right-panels">
          <div class="right-header">
            <div class="header-labels">
              <span>平均值</span>
              <span>最大值</span>
              <span>最小值</span>
              <span>均方根值</span>
              <span>標準差</span>
              <span>變異數</span>
              <span>25%分位數</span>
              <span>中位數</span>

              <span>75%分位數</span>
            </div>
            <div class="header-values">
              <span id="header-mean">-</span>
              <span id="header-max">-</span>
              <span id="header-min">-</span>
              <span id="header-rms">-</span>
              <span id="header-std">-</span>
              <span id="header-var">-</span>
              <span id="header-q25">-</span>
              <span id="header-median">-</span>

              <span id="header-q75">-</span>
            </div>
          </div>
          <div class="right-top">
            <ul
              class="nav nav-underline nav-justified"
              id="tabSwitcher"
              role="tablist"
            >
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link active"
                  id="chart-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#chart"
                  type="button"
                  role="tab"
                >
                  圖表
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="table-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#table"
                  type="button"
                  role="tab"
                >
                  表格
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="fft-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#fft"
                  type="button"
                  role="tab"
                >
                  FFT 頻譜
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="compare-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#compare"
                  type="button"
                  role="tab"
                >
                  疊圖比較
                </button>
              </li>
            </ul>
            <div class="tab-content" id="tabContent">
              <div class="tab-pane fade show active" id="chart" role="tabpanel">
                <div id="myPlot" style="width: 100%; height: 100%"></div>
              </div>
              <div class="tab-pane fade" id="table" role="tabpanel">
                <table id="myTable" class="display" style="width: 100%"></table>
              </div>
              <div class="tab-pane fade" id="fft" role="tabpanel">
                <div id="fftPlot" style="width: 100%; height: 100%"></div>
              </div>
              <div class="tab-pane fade" id="compare" role="tabpanel">
                <div id="comparePlot" style="width: 100%; height: 100%"></div>
              </div>
            </div>
          </div>
          <div class="right-bottom">
            <div
              class="bottom-buttons d-flex align-items-center justify-content-end gap-2"
            >
              <label for="save-target" class="form-label mb-0 me-1"
                >儲存分頁：</label
              >
              <select id="save-target" class="form-select" style="width: 120px">
                <option value="chart_original">原圖表</option>
                <option value="chart_current">目前圖表</option>
                <option value="fft">FFT</option>
                <option value="compare">疊圖</option>
              </select>
              <label for="save-type" class="form-label mb-0 ms-2 me-1"
                >檔案類型：</label
              >
              <select id="save-type" class="form-select" style="width: 100px">
                <option value="csv">CSV</option>
                <option value="png">PNG</option>
              </select>
              <button type="button" class="btn btn-dark ms-2" id="save-btn">
                儲存
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="{{ url_for('static', filename='main_v3.js', v=1) }}"></script>
  </body>
</html>
