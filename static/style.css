:root {
  --bg-panel: #e6e8ea;
  --border-panel: #bfc3c7;
  --text-main: #232a3b;
  --bg-body-from: #f8f9fa;
  --bg-body-to: #e9ecef;
  --header-val-color: #1a6cff;
  --btn-bg: #ffffff;
}

[data-bs-theme="dark"] {
  --bg-panel: #212529;
  --border-panel: #495057;
  --text-main: #f8f9fa;
  --bg-body-from: #000000;
  --bg-body-to: #1a1d20;
  --header-val-color: #6ea8fe;
  --btn-bg: #212529;
}

[data-bs-theme="dark"] #save-btn {
  background-color: #ffffff;
  color: #212529;
  border-color: #ffffff;
}

/* 淺色模式下，主題切換按鈕 hover 變黑 */
:not([data-bs-theme="dark"]) #theme-toggle:hover {
  background-color: #000000 !important;
  color: #ffffff !important;
}

/* 深色模式下，主題切換按鈕 hover 變白 (反轉) */
[data-bs-theme="dark"] #theme-toggle:hover {
  background-color: #ffffff !important;
  color: #000000 !important;
}
/* 修正深色模式下禁用按鈕看不見的問題 */
[data-bs-theme="dark"] .btn:disabled {
  color: #adb5bd !important;
  border-color: #6c757d !important;
  opacity: 0.5;
}

/* 強制深色模式選單樣式 */
[data-bs-theme="dark"] .form-select,
[data-bs-theme="dark"] .form-control {
  background-color: #2b3035;
  border-color: #495057;
  color: #dee2e6;
}

[data-bs-theme="dark"] .form-select:focus,
[data-bs-theme="dark"] .form-control:focus {
  background-color: #2b3035;
  border-color: #86b7fe;
  color: #dee2e6;
  box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

[data-bs-theme="dark"] .form-select option {
  background-color: #2b3035;
  color: #dee2e6;
}

[data-bs-theme="dark"] ::placeholder {
  color: #adb5bd !important;
  opacity: 1;
}

[data-bs-theme="dark"] #version-badge {
  background-color: #495057 !important;
  color: #dee2e6 !important;
  border-color: #6c757d !important;
}

/* right-bottom 5 按鈕橫向排列現代感 */
.bottom-buttons {
  display: flex;
  gap: 20px;
  justify-content: center;
  align-items: center;
  margin: 8px 0;
}
.bottom-buttons .btn {
  flex: 1 1 0;
  min-width: 0;
  font-size: 1em;
  font-weight: 600;
  border-radius: 8px;
  letter-spacing: 0.02em;
}

/* Button Hover and Active Effects */
.btn {
  transition: all 0.2s ease;
}

.btn:hover {
  filter: brightness(1.1);
  transform: translateY(-2px);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
}

.btn:active {
  filter: brightness(0.95);
  transform: translateY(0) scale(0.98);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.header-labels span,
.header-values span {
  flex: 1;
  text-align: center;
  min-width: 0;
}
/* right-header 標籤與數值現代感樣式 */
.header-labels,
.header-values {
  display: flex;
  gap: 24px;
  font-family: "Montserrat", "Segoe UI", Arial, sans-serif;
  font-size: 1.15em;
  font-weight: 600;
  color: var(--text-main);
  letter-spacing: 0.02em;
  align-items: center;
}
.header-values {
  margin-top: 4px;
  font-size: 1.22em;
  font-weight: bold;
  color: var(--header-val-color);
}
/* 右上標題分區樣式 */
.right-header {
  width: 100%;
  background: var(--bg-panel);
  border-radius: 16px 16px 0 0;
  border: 1.5px solid var(--border-panel);
  padding: 8px;
  box-sizing: border-box;
  justify-content: space-between;
  min-height: 90px;
  display: flex;
  flex-direction: column; 
  /* flex-direction: row 為預設，這裡改為 column 讓兩行對齊更好 ? 
     Index.html 結構是 header-labels 和 header-values 兩個 div. 
     原本 CSS 沒寫 flex-direction, 預設是 row? 
     Wait, .right-header content is:
     <div class="header-labels">...</div>
     <div class="header-values">...</div>
     If default is row, they are side-by-side. 
     Use column to stack them if that was the intention, or check if they were side-by-side.
     Looking at the screenshot description or inference: 
     "stats" usually are label above value. 
     If they are row, they are left/right. 
     
     Let's check index.html again. 
     It has header-labels and header-values. 
     Inside header-labels: span, span...
     If right-header is flex row (default), then labels block is left, values block is right? 
     No, `header-values` has `margin-top: 4px`. This implies stacking.
     So right-header should probably be flex-direction: column.
     The original CSS had `/* flex-direction: row 為預設，可省略 */` but that might be a wrong comment if the user sees stacked. 
     Actually, if they are `div`s and no flex is applied `display: flex` on parent, they become flex items using row direction.
     So labels left, values right.
     However, header-values has `margin-top: 4px`. This suggests vertical spacing.
     If they are side by side, margin-top pushes it down... relative to what?
     
     Let's preserve existing flex behavior but fix height.
     If the user wants "header height small", stacking them saves horizontal space? No, stacking takes vertical space.
     Wait, if they are row, they take less height (only max height of one row).
     If they are column, they take sum of heights.
     
     The user said "right-header 高度小一點".
     If it was 200px min-height, simply reducing that is the main key.
     Let's just change min-height to 90px.
  */
}

/* 讓 tab-content 和 tab-pane 高度一致，圖表自動填滿 */
.right-top .tab-content {
  flex: 1 1 0;
  min-height: 0;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: stretch;
  width: 100%;
  height: 100%;
  padding: 4px;
  overflow: hidden;
}

.right-top .tab-pane {
  height: 100%;
  display: flex;
  flex-direction: column;
}

/* 右上分區自動填滿，內容可縮放，flex 可調整大小 */
.right-top {
  background: var(--bg-panel);
  border-radius: 0;
  border: 1.5px solid var(--border-panel);
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  min-width: 0;
  min-height: 0;
  padding: 8px;
  overflow: hidden;
  transition: border 0.2s;
  flex: 1; /* Replace height: 100% with flex: 1 to fill remaining space properly */
  gap: 0;
}

.right-top .nav-tabs {
  flex-shrink: 0;
}

/* canvas 自動縮放不超出分區，最大填滿剩餘空間 */
.right-top canvas {
  width: 100% !important;
  height: 100% !important;
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  margin: 0 auto;
  display: block;
  background: transparent;
  box-sizing: border-box;
  /* 移除 aspect-ratio，讓高度自動填滿分區 */
}

body {
  font-family: "Montserrat", "Segoe UI", Arial, sans-serif;
  background: linear-gradient(120deg, var(--bg-body-from) 0%, var(--bg-body-to) 100%);
  margin: 0;
  padding: 0;
  min-height: 100vh;
  font-size: 20px;
  color: var(--text-main);
  letter-spacing: 0.02em;
}

.layout-root {
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  gap: 8px;
  max-width: 100vw;
  max-height: 100vh;
  padding: 16px;
}

html,
body {
  width: 100vw;
  height: 100vh;
  overflow: hidden;
}

.bottom-row {
  display: flex;
  flex: auto;
  gap: 8px;
  min-height: 0;
  height: 0;
}

.right-panels {
  flex: 3 1 0;
  display: flex;
  flex-direction: column;
  gap: 8px; /* 內部垂直間距 */
  height: 100%;
  min-width: 0;
}

.top-panel {
  width: 100%;
  background: var(--bg-panel);
  border-radius: 16px;
  border: 1.5px solid var(--border-panel);
  padding: 8px;
  margin-bottom: 0;
  transition: border 0.2s;
  min-height: 60px;
}

.left-panel {
  background: var(--bg-panel);
  border-radius: 16px;
  border: 1.5px solid var(--border-panel);
  margin-bottom: 0;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  flex: 1 1 0;
  min-width: 0; /* min-width: 400px 與 min-width: 0 重複，保留為 0 使其彈性 */
  padding: 8px;
  gap: 8px;
  box-sizing: border-box;
  max-width: 400px;
}

.right-panel {
  flex: 3 1 0;
  display: flex;
  flex-direction: column;
  gap: 24px;
  min-width: 320px;
}

.right-bottom {
  border-radius: 0 0 16px 16px;
  box-sizing: border-box;
  min-height: 100px;
  transition: border 0.2s;
  width: 100%;
  background: var(--bg-panel);
  border: 1.5px solid var(--border-panel);
  padding: 8px;
}

/* 響應式 */
@media (max-width: 1200px) {
  .layout-root {
    padding: 8px;
  }

  .left-panel {
    padding: 4px;
    border-radius: 8px;
    max-width: 200px;
  }
  .top-panel {
    padding: 4px;
    border-radius: 8px;
  }
  .right-bottom {
    padding: 4px;
    border-radius: 0 0 8px 8px;
  }
  .right-header {
    padding: 4px;
    border-radius: 8px 8px 0 0;
  }
}
